# serverless plugins
serverless-offline:
  httpPort: 3002
  noPrependStageInUrl: true
  apiKey: d41d8cd98f00b204e9800998ecf8427e
  disableScheduledEvents: true
serverless-iam-roles-per-function:
  defaultInherit: true

# serverless general config
basename: ${self:service}-${self:provider.stage}
sesRegion: us-east-1
domain: omie-harbor.app

httpCors:
  origin: '*'
  headers:
    - Content-Type
    - Cache-Control
    - X-Api-Key
  allowCredentials: false
functionsWarmUpScheduledEvent:
  description: Function warm up each five minutes
  rate: rate(5 minutes)
  enabled: ${self:custom.functionsWarmUpScheduledEventEnabled.${self:provider.stage}}
  input: '{"warmUp":true}'

# serverless config by environment
region:
  dev: us-east-1
  prd: sa-east-1
zones:
  dev:
    - ${self:custom.region.${self:provider.stage}}a
  prd:
    - ${self:custom.region.${self:provider.stage}}a
    - ${self:custom.region.${self:provider.stage}}b
functionsWarmUpScheduledEventEnabled:
  dev: false
  prd: false
ingestionDispatcherSchedule1:
  dev:
    rate: cron(0 8 ? * * *) # everyday at 08:00 UTC (05:00 BR)
    enabled: true
  prd:
    rate: cron(0 9 ? * * *) # everyday at 09:00 UTC (06:00 BR)
    enabled: true
ingestionDispatcherSchedule2:
  dev:
    rate: cron(0 14 ? * * *) # everyday at 14:00 UTC (11:00 BR)
    enabled: true
  prd:
    rate: cron(0 15 ? * * *) # everyday at 15:00 UTC (12:00 BR)
    enabled: true
ingestionDispatcherSchedule3:
  dev:
    rate: cron(0 20 ? * * *) # everyday at 20:00 UTC (17:00 BR)
    enabled: true
  prd:
    rate: cron(0 21 ? * * *) # everyday at 21:00 UTC (18:00 BR)
    enabled: true
dataExport:
  dev:
    memorySize: 4096
  prd:
    memorySize: 3008

# application environment variables
env:
  FLAG_UPDATE_EMPTY_RECORDS:
    dev: false
    prd: false
  FLAG_LOG_EACH_OMIE_ERROR:
    dev: false
    prd: false